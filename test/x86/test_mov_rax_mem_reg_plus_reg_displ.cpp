
#include "bonk/backend/x86/instructions/x86_mov.hpp"
#include "bonk/backend/x86/x86_command_buffer.hpp"
#include "../utils/test_buffer_eq.hpp"
#include "gtest/gtest.h"

using namespace bonk::x86_backend;

TEST(EncodingX86, MovCommandRaxMemRegPlusRegDispl) {
    auto* cbuffer = new CommandBuffer();
    //    mov rax, [reg + reg + disp32]
    for (int i = 0; i < 16; i++) {
        for (int j = 0; j < 16; j++) {
            if (i == rsp && j == rsp)
                continue;
            cbuffer->root_list->insert_tail(
                new MovCommand(CommandParameter::create_register_64(rax),
                                CommandParameter::create_memory(
                                    CommandParameterMemory::create_reg_reg_displ(i, j, -512))));
        }
    }

    auto encoder = cbuffer->to_bytes();
    auto& buffer = encoder->buffer;

    // There are special cases if rsp, rbp, r12 and r13 are in the memory operand.
    // They are not encoded in the same way as the other registers.

    // clang-format off
    const char* correct_buffer =
        "488b840000feffff" // mov    rax,QWORD PTR [rax+rax*1-0x200]
        "488b840100feffff" // mov    rax,QWORD PTR [rcx+rax*1-0x200]
        "488b840200feffff" // mov    rax,QWORD PTR [rdx+rax*1-0x200]
        "488b840300feffff" // mov    rax,QWORD PTR [rbx+rax*1-0x200]
        "488b840400feffff" // mov    rax,QWORD PTR [rsp+rax*1-0x200]
        "488b842800feffff" // mov    rax,QWORD PTR [rax+rbp*1-0x200]
        "488b840600feffff" // mov    rax,QWORD PTR [rsi+rax*1-0x200]
        "488b840700feffff" // mov    rax,QWORD PTR [rdi+rax*1-0x200]
        "498b840000feffff" // mov    rax,QWORD PTR [r8+rax*1-0x200]
        "498b840100feffff" // mov    rax,QWORD PTR [r9+rax*1-0x200]
        "498b840200feffff" // mov    rax,QWORD PTR [r10+rax*1-0x200]
        "498b840300feffff" // mov    rax,QWORD PTR [r11+rax*1-0x200]
        "498b840400feffff" // mov    rax,QWORD PTR [r12+rax*1-0x200]
        "4a8b842800feffff" // mov    rax,QWORD PTR [rax+r13*1-0x200]
        "498b840600feffff" // mov    rax,QWORD PTR [r14+rax*1-0x200]
        "498b840700feffff" // mov    rax,QWORD PTR [r15+rax*1-0x200]
        "488b840800feffff" // mov    rax,QWORD PTR [rax+rcx*1-0x200]
        "488b840900feffff" // mov    rax,QWORD PTR [rcx+rcx*1-0x200]
        "488b840a00feffff" // mov    rax,QWORD PTR [rdx+rcx*1-0x200]
        "488b840b00feffff" // mov    rax,QWORD PTR [rbx+rcx*1-0x200]
        "488b840c00feffff" // mov    rax,QWORD PTR [rsp+rcx*1-0x200]
        "488b842900feffff" // mov    rax,QWORD PTR [rcx+rbp*1-0x200]
        "488b840e00feffff" // mov    rax,QWORD PTR [rsi+rcx*1-0x200]
        "488b840f00feffff" // mov    rax,QWORD PTR [rdi+rcx*1-0x200]
        "498b840800feffff" // mov    rax,QWORD PTR [r8+rcx*1-0x200]
        "498b840900feffff" // mov    rax,QWORD PTR [r9+rcx*1-0x200]
        "498b840a00feffff" // mov    rax,QWORD PTR [r10+rcx*1-0x200]
        "498b840b00feffff" // mov    rax,QWORD PTR [r11+rcx*1-0x200]
        "498b840c00feffff" // mov    rax,QWORD PTR [r12+rcx*1-0x200]
        "4a8b842900feffff" // mov    rax,QWORD PTR [rcx+r13*1-0x200]
        "498b840e00feffff" // mov    rax,QWORD PTR [r14+rcx*1-0x200]
        "498b840f00feffff" // mov    rax,QWORD PTR [r15+rcx*1-0x200]
        "488b841000feffff" // mov    rax,QWORD PTR [rax+rdx*1-0x200]
        "488b841100feffff" // mov    rax,QWORD PTR [rcx+rdx*1-0x200]
        "488b841200feffff" // mov    rax,QWORD PTR [rdx+rdx*1-0x200]
        "488b841300feffff" // mov    rax,QWORD PTR [rbx+rdx*1-0x200]
        "488b841400feffff" // mov    rax,QWORD PTR [rsp+rdx*1-0x200]
        "488b842a00feffff" // mov    rax,QWORD PTR [rdx+rbp*1-0x200]
        "488b841600feffff" // mov    rax,QWORD PTR [rsi+rdx*1-0x200]
        "488b841700feffff" // mov    rax,QWORD PTR [rdi+rdx*1-0x200]
        "498b841000feffff" // mov    rax,QWORD PTR [r8+rdx*1-0x200]
        "498b841100feffff" // mov    rax,QWORD PTR [r9+rdx*1-0x200]
        "498b841200feffff" // mov    rax,QWORD PTR [r10+rdx*1-0x200]
        "498b841300feffff" // mov    rax,QWORD PTR [r11+rdx*1-0x200]
        "498b841400feffff" // mov    rax,QWORD PTR [r12+rdx*1-0x200]
        "4a8b842a00feffff" // mov    rax,QWORD PTR [rdx+r13*1-0x200]
        "498b841600feffff" // mov    rax,QWORD PTR [r14+rdx*1-0x200]
        "498b841700feffff" // mov    rax,QWORD PTR [r15+rdx*1-0x200]
        "488b841800feffff" // mov    rax,QWORD PTR [rax+rbx*1-0x200]
        "488b841900feffff" // mov    rax,QWORD PTR [rcx+rbx*1-0x200]
        "488b841a00feffff" // mov    rax,QWORD PTR [rdx+rbx*1-0x200]
        "488b841b00feffff" // mov    rax,QWORD PTR [rbx+rbx*1-0x200]
        "488b841c00feffff" // mov    rax,QWORD PTR [rsp+rbx*1-0x200]
        "488b842b00feffff" // mov    rax,QWORD PTR [rbx+rbp*1-0x200]
        "488b841e00feffff" // mov    rax,QWORD PTR [rsi+rbx*1-0x200]
        "488b841f00feffff" // mov    rax,QWORD PTR [rdi+rbx*1-0x200]
        "498b841800feffff" // mov    rax,QWORD PTR [r8+rbx*1-0x200]
        "498b841900feffff" // mov    rax,QWORD PTR [r9+rbx*1-0x200]
        "498b841a00feffff" // mov    rax,QWORD PTR [r10+rbx*1-0x200]
        "498b841b00feffff" // mov    rax,QWORD PTR [r11+rbx*1-0x200]
        "498b841c00feffff" // mov    rax,QWORD PTR [r12+rbx*1-0x200]
        "4a8b842b00feffff" // mov    rax,QWORD PTR [rbx+r13*1-0x200]
        "498b841e00feffff" // mov    rax,QWORD PTR [r14+rbx*1-0x200]
        "498b841f00feffff" // mov    rax,QWORD PTR [r15+rbx*1-0x200]
        "488b840400feffff" // mov    rax,QWORD PTR [rsp+rax*1-0x200]
        "488b840c00feffff" // mov    rax,QWORD PTR [rsp+rcx*1-0x200]
        "488b841400feffff" // mov    rax,QWORD PTR [rsp+rdx*1-0x200]
        "488b841c00feffff" // mov    rax,QWORD PTR [rsp+rbx*1-0x200]
        "488b842c00feffff" // mov    rax,QWORD PTR [rsp+rbp*1-0x200]
        "488b843400feffff" // mov    rax,QWORD PTR [rsp+rsi*1-0x200]
        "488b843c00feffff" // mov    rax,QWORD PTR [rsp+rdi*1-0x200]
        "4a8b840400feffff" // mov    rax,QWORD PTR [rsp+r8*1-0x200]
        "4a8b840c00feffff" // mov    rax,QWORD PTR [rsp+r9*1-0x200]
        "4a8b841400feffff" // mov    rax,QWORD PTR [rsp+r10*1-0x200]
        "4a8b841c00feffff" // mov    rax,QWORD PTR [rsp+r11*1-0x200]
        "4a8b842400feffff" // mov    rax,QWORD PTR [rsp+r12*1-0x200]
        "4a8b842c00feffff" // mov    rax,QWORD PTR [rsp+r13*1-0x200]
        "4a8b843400feffff" // mov    rax,QWORD PTR [rsp+r14*1-0x200]
        "4a8b843c00feffff" // mov    rax,QWORD PTR [rsp+r15*1-0x200]
        "488b842800feffff" // mov    rax,QWORD PTR [rax+rbp*1-0x200]
        "488b842900feffff" // mov    rax,QWORD PTR [rcx+rbp*1-0x200]
        "488b842a00feffff" // mov    rax,QWORD PTR [rdx+rbp*1-0x200]
        "488b842b00feffff" // mov    rax,QWORD PTR [rbx+rbp*1-0x200]
        "488b842c00feffff" // mov    rax,QWORD PTR [rsp+rbp*1-0x200]
        "488b842d00feffff" // mov    rax,QWORD PTR [rbp+rbp*1-0x200]
        "488b842e00feffff" // mov    rax,QWORD PTR [rsi+rbp*1-0x200]
        "488b842f00feffff" // mov    rax,QWORD PTR [rdi+rbp*1-0x200]
        "498b842800feffff" // mov    rax,QWORD PTR [r8+rbp*1-0x200]
        "498b842900feffff" // mov    rax,QWORD PTR [r9+rbp*1-0x200]
        "498b842a00feffff" // mov    rax,QWORD PTR [r10+rbp*1-0x200]
        "498b842b00feffff" // mov    rax,QWORD PTR [r11+rbp*1-0x200]
        "498b842c00feffff" // mov    rax,QWORD PTR [r12+rbp*1-0x200]
        "498b842d00feffff" // mov    rax,QWORD PTR [r13+rbp*1-0x200]
        "498b842e00feffff" // mov    rax,QWORD PTR [r14+rbp*1-0x200]
        "498b842f00feffff" // mov    rax,QWORD PTR [r15+rbp*1-0x200]
        "488b843000feffff" // mov    rax,QWORD PTR [rax+rsi*1-0x200]
        "488b843100feffff" // mov    rax,QWORD PTR [rcx+rsi*1-0x200]
        "488b843200feffff" // mov    rax,QWORD PTR [rdx+rsi*1-0x200]
        "488b843300feffff" // mov    rax,QWORD PTR [rbx+rsi*1-0x200]
        "488b843400feffff" // mov    rax,QWORD PTR [rsp+rsi*1-0x200]
        "488b842e00feffff" // mov    rax,QWORD PTR [rsi+rbp*1-0x200]
        "488b843600feffff" // mov    rax,QWORD PTR [rsi+rsi*1-0x200]
        "488b843700feffff" // mov    rax,QWORD PTR [rdi+rsi*1-0x200]
        "498b843000feffff" // mov    rax,QWORD PTR [r8+rsi*1-0x200]
        "498b843100feffff" // mov    rax,QWORD PTR [r9+rsi*1-0x200]
        "498b843200feffff" // mov    rax,QWORD PTR [r10+rsi*1-0x200]
        "498b843300feffff" // mov    rax,QWORD PTR [r11+rsi*1-0x200]
        "498b843400feffff" // mov    rax,QWORD PTR [r12+rsi*1-0x200]
        "4a8b842e00feffff" // mov    rax,QWORD PTR [rsi+r13*1-0x200]
        "498b843600feffff" // mov    rax,QWORD PTR [r14+rsi*1-0x200]
        "498b843700feffff" // mov    rax,QWORD PTR [r15+rsi*1-0x200]
        "488b843800feffff" // mov    rax,QWORD PTR [rax+rdi*1-0x200]
        "488b843900feffff" // mov    rax,QWORD PTR [rcx+rdi*1-0x200]
        "488b843a00feffff" // mov    rax,QWORD PTR [rdx+rdi*1-0x200]
        "488b843b00feffff" // mov    rax,QWORD PTR [rbx+rdi*1-0x200]
        "488b843c00feffff" // mov    rax,QWORD PTR [rsp+rdi*1-0x200]
        "488b842f00feffff" // mov    rax,QWORD PTR [rdi+rbp*1-0x200]
        "488b843e00feffff" // mov    rax,QWORD PTR [rsi+rdi*1-0x200]
        "488b843f00feffff" // mov    rax,QWORD PTR [rdi+rdi*1-0x200]
        "498b843800feffff" // mov    rax,QWORD PTR [r8+rdi*1-0x200]
        "498b843900feffff" // mov    rax,QWORD PTR [r9+rdi*1-0x200]
        "498b843a00feffff" // mov    rax,QWORD PTR [r10+rdi*1-0x200]
        "498b843b00feffff" // mov    rax,QWORD PTR [r11+rdi*1-0x200]
        "498b843c00feffff" // mov    rax,QWORD PTR [r12+rdi*1-0x200]
        "4a8b842f00feffff" // mov    rax,QWORD PTR [rdi+r13*1-0x200]
        "498b843e00feffff" // mov    rax,QWORD PTR [r14+rdi*1-0x200]
        "498b843f00feffff" // mov    rax,QWORD PTR [r15+rdi*1-0x200]
        "4a8b840000feffff" // mov    rax,QWORD PTR [rax+r8*1-0x200]
        "4a8b840100feffff" // mov    rax,QWORD PTR [rcx+r8*1-0x200]
        "4a8b840200feffff" // mov    rax,QWORD PTR [rdx+r8*1-0x200]
        "4a8b840300feffff" // mov    rax,QWORD PTR [rbx+r8*1-0x200]
        "4a8b840400feffff" // mov    rax,QWORD PTR [rsp+r8*1-0x200]
        "498b842800feffff" // mov    rax,QWORD PTR [r8+rbp*1-0x200]
        "4a8b840600feffff" // mov    rax,QWORD PTR [rsi+r8*1-0x200]
        "4a8b840700feffff" // mov    rax,QWORD PTR [rdi+r8*1-0x200]
        "4b8b840000feffff" // mov    rax,QWORD PTR [r8+r8*1-0x200]
        "4b8b840100feffff" // mov    rax,QWORD PTR [r9+r8*1-0x200]
        "4b8b840200feffff" // mov    rax,QWORD PTR [r10+r8*1-0x200]
        "4b8b840300feffff" // mov    rax,QWORD PTR [r11+r8*1-0x200]
        "4b8b840400feffff" // mov    rax,QWORD PTR [r12+r8*1-0x200]
        "4b8b842800feffff" // mov    rax,QWORD PTR [r8+r13*1-0x200]
        "4b8b840600feffff" // mov    rax,QWORD PTR [r14+r8*1-0x200]
        "4b8b840700feffff" // mov    rax,QWORD PTR [r15+r8*1-0x200]
        "4a8b840800feffff" // mov    rax,QWORD PTR [rax+r9*1-0x200]
        "4a8b840900feffff" // mov    rax,QWORD PTR [rcx+r9*1-0x200]
        "4a8b840a00feffff" // mov    rax,QWORD PTR [rdx+r9*1-0x200]
        "4a8b840b00feffff" // mov    rax,QWORD PTR [rbx+r9*1-0x200]
        "4a8b840c00feffff" // mov    rax,QWORD PTR [rsp+r9*1-0x200]
        "498b842900feffff" // mov    rax,QWORD PTR [r9+rbp*1-0x200]
        "4a8b840e00feffff" // mov    rax,QWORD PTR [rsi+r9*1-0x200]
        "4a8b840f00feffff" // mov    rax,QWORD PTR [rdi+r9*1-0x200]
        "4b8b840800feffff" // mov    rax,QWORD PTR [r8+r9*1-0x200]
        "4b8b840900feffff" // mov    rax,QWORD PTR [r9+r9*1-0x200]
        "4b8b840a00feffff" // mov    rax,QWORD PTR [r10+r9*1-0x200]
        "4b8b840b00feffff" // mov    rax,QWORD PTR [r11+r9*1-0x200]
        "4b8b840c00feffff" // mov    rax,QWORD PTR [r12+r9*1-0x200]
        "4b8b842900feffff" // mov    rax,QWORD PTR [r9+r13*1-0x200]
        "4b8b840e00feffff" // mov    rax,QWORD PTR [r14+r9*1-0x200]
        "4b8b840f00feffff" // mov    rax,QWORD PTR [r15+r9*1-0x200]
        "4a8b841000feffff" // mov    rax,QWORD PTR [rax+r10*1-0x200]
        "4a8b841100feffff" // mov    rax,QWORD PTR [rcx+r10*1-0x200]
        "4a8b841200feffff" // mov    rax,QWORD PTR [rdx+r10*1-0x200]
        "4a8b841300feffff" // mov    rax,QWORD PTR [rbx+r10*1-0x200]
        "4a8b841400feffff" // mov    rax,QWORD PTR [rsp+r10*1-0x200]
        "498b842a00feffff" // mov    rax,QWORD PTR [r10+rbp*1-0x200]
        "4a8b841600feffff" // mov    rax,QWORD PTR [rsi+r10*1-0x200]
        "4a8b841700feffff" // mov    rax,QWORD PTR [rdi+r10*1-0x200]
        "4b8b841000feffff" // mov    rax,QWORD PTR [r8+r10*1-0x200]
        "4b8b841100feffff" // mov    rax,QWORD PTR [r9+r10*1-0x200]
        "4b8b841200feffff" // mov    rax,QWORD PTR [r10+r10*1-0x200]
        "4b8b841300feffff" // mov    rax,QWORD PTR [r11+r10*1-0x200]
        "4b8b841400feffff" // mov    rax,QWORD PTR [r12+r10*1-0x200]
        "4b8b842a00feffff" // mov    rax,QWORD PTR [r10+r13*1-0x200]
        "4b8b841600feffff" // mov    rax,QWORD PTR [r14+r10*1-0x200]
        "4b8b841700feffff" // mov    rax,QWORD PTR [r15+r10*1-0x200]
        "4a8b841800feffff" // mov    rax,QWORD PTR [rax+r11*1-0x200]
        "4a8b841900feffff" // mov    rax,QWORD PTR [rcx+r11*1-0x200]
        "4a8b841a00feffff" // mov    rax,QWORD PTR [rdx+r11*1-0x200]
        "4a8b841b00feffff" // mov    rax,QWORD PTR [rbx+r11*1-0x200]
        "4a8b841c00feffff" // mov    rax,QWORD PTR [rsp+r11*1-0x200]
        "498b842b00feffff" // mov    rax,QWORD PTR [r11+rbp*1-0x200]
        "4a8b841e00feffff" // mov    rax,QWORD PTR [rsi+r11*1-0x200]
        "4a8b841f00feffff" // mov    rax,QWORD PTR [rdi+r11*1-0x200]
        "4b8b841800feffff" // mov    rax,QWORD PTR [r8+r11*1-0x200]
        "4b8b841900feffff" // mov    rax,QWORD PTR [r9+r11*1-0x200]
        "4b8b841a00feffff" // mov    rax,QWORD PTR [r10+r11*1-0x200]
        "4b8b841b00feffff" // mov    rax,QWORD PTR [r11+r11*1-0x200]
        "4b8b841c00feffff" // mov    rax,QWORD PTR [r12+r11*1-0x200]
        "4b8b842b00feffff" // mov    rax,QWORD PTR [r11+r13*1-0x200]
        "4b8b841e00feffff" // mov    rax,QWORD PTR [r14+r11*1-0x200]
        "4b8b841f00feffff" // mov    rax,QWORD PTR [r15+r11*1-0x200]
        "4a8b842000feffff" // mov    rax,QWORD PTR [rax+r12*1-0x200]
        "4a8b842100feffff" // mov    rax,QWORD PTR [rcx+r12*1-0x200]
        "4a8b842200feffff" // mov    rax,QWORD PTR [rdx+r12*1-0x200]
        "4a8b842300feffff" // mov    rax,QWORD PTR [rbx+r12*1-0x200]
        "4a8b842400feffff" // mov    rax,QWORD PTR [rsp+r12*1-0x200]
        "498b842c00feffff" // mov    rax,QWORD PTR [r12+rbp*1-0x200]
        "4a8b842600feffff" // mov    rax,QWORD PTR [rsi+r12*1-0x200]
        "4a8b842700feffff" // mov    rax,QWORD PTR [rdi+r12*1-0x200]
        "4b8b842000feffff" // mov    rax,QWORD PTR [r8+r12*1-0x200]
        "4b8b842100feffff" // mov    rax,QWORD PTR [r9+r12*1-0x200]
        "4b8b842200feffff" // mov    rax,QWORD PTR [r10+r12*1-0x200]
        "4b8b842300feffff" // mov    rax,QWORD PTR [r11+r12*1-0x200]
        "4b8b842400feffff" // mov    rax,QWORD PTR [r12+r12*1-0x200]
        "4b8b842c00feffff" // mov    rax,QWORD PTR [r12+r13*1-0x200]
        "4b8b842600feffff" // mov    rax,QWORD PTR [r14+r12*1-0x200]
        "4b8b842700feffff" // mov    rax,QWORD PTR [r15+r12*1-0x200]
        "4a8b842800feffff" // mov    rax,QWORD PTR [rax+r13*1-0x200]
        "4a8b842900feffff" // mov    rax,QWORD PTR [rcx+r13*1-0x200]
        "4a8b842a00feffff" // mov    rax,QWORD PTR [rdx+r13*1-0x200]
        "4a8b842b00feffff" // mov    rax,QWORD PTR [rbx+r13*1-0x200]
        "4a8b842c00feffff" // mov    rax,QWORD PTR [rsp+r13*1-0x200]
        "4a8b842d00feffff" // mov    rax,QWORD PTR [rbp+r13*1-0x200]
        "4a8b842e00feffff" // mov    rax,QWORD PTR [rsi+r13*1-0x200]
        "4a8b842f00feffff" // mov    rax,QWORD PTR [rdi+r13*1-0x200]
        "4b8b842800feffff" // mov    rax,QWORD PTR [r8+r13*1-0x200]
        "4b8b842900feffff" // mov    rax,QWORD PTR [r9+r13*1-0x200]
        "4b8b842a00feffff" // mov    rax,QWORD PTR [r10+r13*1-0x200]
        "4b8b842b00feffff" // mov    rax,QWORD PTR [r11+r13*1-0x200]
        "4b8b842c00feffff" // mov    rax,QWORD PTR [r12+r13*1-0x200]
        "4b8b842d00feffff" // mov    rax,QWORD PTR [r13+r13*1-0x200]
        "4b8b842e00feffff" // mov    rax,QWORD PTR [r14+r13*1-0x200]
        "4b8b842f00feffff" // mov    rax,QWORD PTR [r15+r13*1-0x200]
        "4a8b843000feffff" // mov    rax,QWORD PTR [rax+r14*1-0x200]
        "4a8b843100feffff" // mov    rax,QWORD PTR [rcx+r14*1-0x200]
        "4a8b843200feffff" // mov    rax,QWORD PTR [rdx+r14*1-0x200]
        "4a8b843300feffff" // mov    rax,QWORD PTR [rbx+r14*1-0x200]
        "4a8b843400feffff" // mov    rax,QWORD PTR [rsp+r14*1-0x200]
        "498b842e00feffff" // mov    rax,QWORD PTR [r14+rbp*1-0x200]
        "4a8b843600feffff" // mov    rax,QWORD PTR [rsi+r14*1-0x200]
        "4a8b843700feffff" // mov    rax,QWORD PTR [rdi+r14*1-0x200]
        "4b8b843000feffff" // mov    rax,QWORD PTR [r8+r14*1-0x200]
        "4b8b843100feffff" // mov    rax,QWORD PTR [r9+r14*1-0x200]
        "4b8b843200feffff" // mov    rax,QWORD PTR [r10+r14*1-0x200]
        "4b8b843300feffff" // mov    rax,QWORD PTR [r11+r14*1-0x200]
        "4b8b843400feffff" // mov    rax,QWORD PTR [r12+r14*1-0x200]
        "4b8b842e00feffff" // mov    rax,QWORD PTR [r14+r13*1-0x200]
        "4b8b843600feffff" // mov    rax,QWORD PTR [r14+r14*1-0x200]
        "4b8b843700feffff" // mov    rax,QWORD PTR [r15+r14*1-0x200]
        "4a8b843800feffff" // mov    rax,QWORD PTR [rax+r15*1-0x200]
        "4a8b843900feffff" // mov    rax,QWORD PTR [rcx+r15*1-0x200]
        "4a8b843a00feffff" // mov    rax,QWORD PTR [rdx+r15*1-0x200]
        "4a8b843b00feffff" // mov    rax,QWORD PTR [rbx+r15*1-0x200]
        "4a8b843c00feffff" // mov    rax,QWORD PTR [rsp+r15*1-0x200]
        "498b842f00feffff" // mov    rax,QWORD PTR [r15+rbp*1-0x200]
        "4a8b843e00feffff" // mov    rax,QWORD PTR [rsi+r15*1-0x200]
        "4a8b843f00feffff" // mov    rax,QWORD PTR [rdi+r15*1-0x200]
        "4b8b843800feffff" // mov    rax,QWORD PTR [r8+r15*1-0x200]
        "4b8b843900feffff" // mov    rax,QWORD PTR [r9+r15*1-0x200]
        "4b8b843a00feffff" // mov    rax,QWORD PTR [r10+r15*1-0x200]
        "4b8b843b00feffff" // mov    rax,QWORD PTR [r11+r15*1-0x200]
        "4b8b843c00feffff" // mov    rax,QWORD PTR [r12+r15*1-0x200]
        "4b8b842f00feffff" // mov    rax,QWORD PTR [r15+r13*1-0x200]
        "4b8b843e00feffff" // mov    rax,QWORD PTR [r14+r15*1-0x200]
        "4b8b843f00feffff";// mov    rax,QWORD PTR [r15+r15*1-0x200]
    // clang-format on

    test_buffer_eq(correct_buffer, buffer);
}
